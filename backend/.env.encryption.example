# HIPAA & GDPR Encryption Environment Configuration
# Copy this file to .env and update with your actual values

# =============================================================================
# MASTER ENCRYPTION KEY (CRITICAL - KEEP SECURE!)
# =============================================================================
# This key encrypts all other encryption keys in the system
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex').substring(0,32))"
# Must be exactly 32 characters (256 bits)
# Store in secure vault (AWS KMS, Azure Key Vault, HashiCorp Vault)
# NEVER commit the actual key to version control!
MASTER_ENCRYPTION_KEY=your_32_char_master_key_here

# =============================================================================
# LEGACY ENCRYPTION KEY (Backward Compatibility)
# =============================================================================
# Used for existing encrypted data (Google Calendar tokens, etc.)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex').substring(0,32))"
# Must be exactly 32 characters (256 bits)
ENCRYPTION_KEY=your_32_char_legacy_key_here

# =============================================================================
# ENCRYPTION SERVICE CONFIGURATION
# =============================================================================
# Key cache TTL in milliseconds (default: 15 minutes)
ENCRYPTION_KEY_CACHE_TTL=900000

# Audit log batch size (default: 10)
AUDIT_LOG_BATCH_SIZE=10

# Audit log flush interval in milliseconds (default: 5 seconds)
AUDIT_LOG_FLUSH_INTERVAL=5000

# =============================================================================
# HIPAA COMPLIANCE SETTINGS
# =============================================================================
# Enable HIPAA audit logging (default: true)
HIPAA_AUDIT_LOGGING_ENABLED=true

# Enable encryption of sensitive fields (default: true)
HIPAA_ENCRYPTION_ENABLED=true

# Data retention period in days (default: 2555 days = 7 years)
HIPAA_RETENTION_PERIOD_DAYS=2555

# Enable automatic data deletion after retention period (default: false)
# WARNING: Enabling this will permanently delete data after retention period
HIPAA_AUTO_DELETION_ENABLED=false

# =============================================================================
# GDPR COMPLIANCE SETTINGS
# =============================================================================
# Enable GDPR data protection features (default: true)
GDPR_DATA_PROTECTION_ENABLED=true

# Enable IP address anonymization in audit logs (default: true)
GDPR_ANONYMIZE_IP_ADDRESSES=true

# Data subject access request email
GDPR_DSAR_EMAIL=privacy@yourorganization.com

# =============================================================================
# KEY MANAGEMENT SETTINGS
# =============================================================================
# Data encryption key rotation period in days (default: 90 days)
KEY_ROTATION_PERIOD_DAYS=90

# Organization key rotation period in days (default: 365 days)
ORG_KEY_ROTATION_PERIOD_DAYS=365

# Enable automatic key rotation (default: false - manual rotation recommended)
AUTO_KEY_ROTATION_ENABLED=false

# Key rotation notification email
KEY_ROTATION_NOTIFICATION_EMAIL=security@yourorganization.com

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Require business justification for PHI access (default: true)
REQUIRE_ACCESS_JUSTIFICATION=true

# Maximum failed access attempts before alert (default: 5)
MAX_FAILED_ACCESS_ATTEMPTS=5

# Enable security alerts (default: true)
SECURITY_ALERTS_ENABLED=true

# Security alert email
SECURITY_ALERT_EMAIL=security@yourorganization.com

# =============================================================================
# DATABASE ENCRYPTION SETTINGS
# =============================================================================
# Database connection SSL mode (require for HIPAA compliance)
DB_SSL_MODE=require

# Enable database query logging for audit (default: false in production)
DB_QUERY_LOGGING=false

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================
# Enable encrypted backups (default: true)
ENCRYPTED_BACKUPS_ENABLED=true

# Backup retention period in days (default: 30 days)
BACKUP_RETENTION_DAYS=30

# Backup encryption key (different from master key)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex').substring(0,32))"
BACKUP_ENCRYPTION_KEY=your_32_char_backup_key_here

# =============================================================================
# DEVELOPMENT SETTINGS (DO NOT USE IN PRODUCTION!)
# =============================================================================
# Disable encryption in development (default: false)
# WARNING: Only set to true in development environments
DISABLE_ENCRYPTION=false

# Use mock encryption keys in development (default: false)
# WARNING: Only set to true in development environments
USE_MOCK_ENCRYPTION_KEYS=false

# Enable detailed encryption error messages (default: false in production)
DETAILED_ENCRYPTION_ERRORS=false

# =============================================================================
# EXTERNAL KEY MANAGEMENT (Optional - for production)
# =============================================================================
# AWS KMS Configuration
# AWS_KMS_KEY_ID=arn:aws:kms:region:account:key/key-id
# AWS_KMS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your_access_key
# AWS_SECRET_ACCESS_KEY=your_secret_key

# Azure Key Vault Configuration
# AZURE_KEY_VAULT_URI=https://your-vault.vault.azure.net/
# AZURE_CLIENT_ID=your_client_id
# AZURE_CLIENT_SECRET=your_client_secret
# AZURE_TENANT_ID=your_tenant_id

# HashiCorp Vault Configuration
# VAULT_ADDR=https://your-vault-server:8200
# VAULT_TOKEN=your_vault_token
# VAULT_KEY_PATH=secret/encryption/master_key

# =============================================================================
# EMERGENCY ACCESS
# =============================================================================
# Emergency access key (for disaster recovery)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex').substring(0,32))"
# Store in separate secure location from master key
EMERGENCY_ACCESS_KEY=your_32_char_emergency_key_here

# Emergency access contact
EMERGENCY_CONTACT=security-team@yourorganization.com

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================
# Enable encryption monitoring (default: true)
ENCRYPTION_MONITORING_ENABLED=true

# Encryption monitoring interval in minutes (default: 60)
ENCRYPTION_MONITORING_INTERVAL=60

# Monitoring alert email
MONITORING_ALERT_EMAIL=ops-team@yourorganization.com

# =============================================================================
# COMPLIANCE REPORTING
# =============================================================================
# Enable automated compliance reports (default: true)
COMPLIANCE_REPORTING_ENABLED=true

# Compliance report generation interval in days (default: 30)
COMPLIANCE_REPORT_INTERVAL_DAYS=30

# Compliance report recipients (comma-separated)
COMPLIANCE_REPORT_RECIPIENTS=privacy@yourorganization.com,security@yourorganization.com

# =============================================================================
# API RATE LIMITING (Security)
# =============================================================================
# Enable rate limiting on encryption endpoints (default: true)
ENCRYPTION_RATE_LIMITING_ENABLED=true

# Maximum requests per minute for encryption endpoints
ENCRYPTION_RATE_LIMIT_PER_MINUTE=100

# =============================================================================
# CORS AND SECURITY HEADERS
# =============================================================================
# Allowed origins for CORS (comma-separated)
CORS_ALLOWED_ORIGINS=https://yourapp.com,https://app.yourapp.com

# Enable security headers (default: true)
SECURITY_HEADERS_ENABLED=true

# =============================================================================
# LOGGING
# =============================================================================
# Encryption audit log level (error, warn, info, debug)
ENCRYPTION_LOG_LEVEL=info

# Log file path for encryption events
ENCRYPTION_LOG_FILE=./logs/encryption-audit.log

# Enable console logging (default: false in production)
ENCRYPTION_CONSOLE_LOGGING=false